<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Database ER Diagram - Premises Rental System</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .info {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #diagram {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        .legend {
            background: #e3f2fd;
            padding: 10px;
            border-left: 4px solid #2196f3;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>üóÑÔ∏è Database ER Diagram</h1>
    <h2 style="text-align: center; color: #666;">Premises Rental System</h2>

    <div class="info">
        <h3>üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:</h3>
        <ul>
            <li><strong>14 —Ç–∞–±–ª–∏—Ü</strong> —Å –ø–æ–ª–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏</li>
            <li><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (users)</strong>: admin, landlord, user</li>
            <li><strong>–ü–æ–º–µ—â–µ–Ω–∏—è (rooms)</strong>: —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, —Ñ–æ—Ç–æ, –æ—Ç–∑—ã–≤–∞–º–∏</li>
            <li><strong>–ê—Ä–µ–Ω–¥–∞ (leases)</strong>: –¥–æ–≥–æ–≤–æ—Ä—ã, –ø–ª–∞—Ç–µ–∂–∏, –∏—Å—Ç–æ—Ä–∏—è</li>
            <li><strong>–ö–æ–º–ø–∞–Ω–∏–∏ –∏ –∑–¥–∞–Ω–∏—è</strong>: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏</li>
            <li><strong>–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</strong>: –∑–∞—è–≤–∫–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –ª–æ–≥–∏</li>
        </ul>
    </div>

    <div id="diagram">
        <div class="mermaid">
erDiagram
    users ||--o{ activity_log : "—Å–æ–∑–¥–∞–µ—Ç"
    users ||--o{ notifications : "–ø–æ–ª—É—á–∞–µ—Ç"
    users ||--o{ reviews : "–ø–∏—à–µ—Ç"
    users ||--o{ favorites : "–¥–æ–±–∞–≤–ª—è–µ—Ç"
    users ||--o{ leases : "–∞—Ä–µ–Ω–¥—É–µ—Ç"
    users ||--o{ maintenance_requests : "—Å–æ–∑–¥–∞–µ—Ç"

    companies ||--o{ buildings : "–≤–ª–∞–¥–µ–µ—Ç"

    buildings ||--o{ rooms : "—Å–æ–¥–µ—Ä–∂–∏—Ç"

    room_categories ||--o{ rooms : "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç"

    rooms ||--o{ room_photos : "–∏–º–µ–µ—Ç"
    rooms ||--o{ reviews : "–æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è"
    rooms ||--o{ favorites : "–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è_–≤"
    rooms ||--o{ leases : "—Å–¥–∞–µ—Ç—Å—è"
    rooms ||--o{ maintenance_requests : "–æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è"

    leases ||--o{ payments : "–æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è"
    leases ||--o{ lease_history : "–∏—Å—Ç–æ—Ä–∏—è"

    users {
        int user_id PK
        string full_name
        string email UK
        string phone
        string role
        string password_hash
        datetime created_at
    }

    companies {
        int company_id PK
        string name
        string tax_id UK
        string address
        string contact_person
        string phone
        string email
        text description
    }

    buildings {
        int building_id PK
        int company_id FK
        string name
        string address
        int year_built
        float total_area
        text description
    }

    room_categories {
        int category_id PK
        string name
        text description
    }

    rooms {
        int room_id PK
        int building_id FK "nullable"
        int category_id FK
        string room_number
        int floor
        float area
        float price_per_month
        string status
        text description
    }

    leases {
        int lease_id PK
        int room_id FK
        int tenant_id FK
        datetime start_date
        datetime end_date
        float monthly_rent
        float deposit
        string status
        datetime created_at
    }

    payments {
        int payment_id PK
        int lease_id FK
        datetime payment_date
        float amount
        string payment_method
        string status
    }

    reviews {
        int review_id PK
        int user_id FK
        int room_id FK
        int rating
        text comment
        datetime created_at
    }

    maintenance_requests {
        int request_id PK
        int room_id FK
        int tenant_id FK
        text description
        string priority
        string status
        datetime created_at
        datetime resolved_at
    }

    activity_log {
        int log_id PK
        int user_id FK
        string action
        datetime created_at
    }

    notifications {
        int notification_id PK
        int user_id FK
        text message
        datetime created_at
        boolean is_read
    }

    favorites {
        int favorite_id PK
        int user_id FK
        int room_id FK
    }

    room_photos {
        int photo_id PK
        int room_id FK
        string photo_url
        text description
    }

    lease_history {
        int history_id PK
        int lease_id FK
        datetime change_date
        string previous_status
        string new_status
        text comment
    }
        </div>
    </div>

    <div class="legend">
        <h3>üîë –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:</h3>
        <ul>
            <li><strong>PK</strong> - Primary Key (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á)</li>
            <li><strong>FK</strong> - Foreign Key (–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á)</li>
            <li><strong>UK</strong> - Unique Key (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)</li>
            <li><strong>||--o{</strong> - –û–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º (One to Many)</li>
        </ul>
        <p><strong>–ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PNG:</strong></p>
        <ol>
            <li>–û—Ç–∫—Ä–æ–π —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ</li>
            <li>–ù–∞–∂–º–∏ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º—É ‚Üí "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–∫..."</li>
            <li>–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Å–∫—Ä–∏–Ω—à–æ—Ç (Ctrl+Shift+S –≤ Firefox/Chrome)</li>
        </ol>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            er: {
                layoutDirection: 'TB'
            }
        });
    </script>
</body>
</html>
